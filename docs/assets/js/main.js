"use strict";const desingLegend=document.querySelector(".js-design-legend"),fillLegend=document.querySelector(".js-fill-legend"),shareLegend=document.querySelector(".js-share-legend"),desingContent=document.querySelector(".js-design-content"),fillContent=document.querySelector(".js-fill-content"),shareContent=document.querySelector(".js-share-content"),fillRotateScroll=document.querySelector(".js-fill-rotate-scroll"),designRotateScroll=document.querySelector(".js-designRotateScroll"),shareRotateScroll=document.querySelector(".js-share-rotate-scroll"),namePreview=document.querySelector(".js-card-nameSurname"),telephonePreview=document.querySelector(".js-card-telephone"),emailPreview=document.querySelector(".js-card-mail"),githubPreview=document.querySelector(".js-card-github"),linkelinPreview=document.querySelector(".js-card-linkedin"),linePreview=document.querySelector(".js-profileText"),borderPreview=document.querySelector(".js-border"),containerColor=document.querySelector(".js-containerColor");let data={palette:"",name:"",job:"",phone:"",email:"",linkedin:"",github:"",photo:""};function closeAllSections(){desingContent.classList.add("collapsed"),fillContent.classList.add("collapsed"),shareContent.classList.add("collapsed"),fillRotateScroll.classList.remove("header--scroll__create-card__rotate"),designRotateScroll.classList.remove("header--scroll__create-card__rotate"),shareRotateScroll.classList.remove("header--scroll__create-card__rotate")}function openDesingSections(){desingContent.classList.remove("collapsed"),designRotateScroll.classList.add("header--scroll__create-card__rotate")}function openFillSections(){fillContent.classList.remove("collapsed"),fillRotateScroll.classList.add("header--scroll__create-card__rotate")}function openShareSections(){shareContent.classList.remove("collapsed"),shareRotateScroll.classList.add("header--scroll__create-card__rotate")}desingLegend.addEventListener("click",e=>{e.preventDefault(),closeAllSections(),openDesingSections()}),fillLegend.addEventListener("click",e=>{e.preventDefault(),closeAllSections(),openFillSections()}),shareLegend.addEventListener("click",e=>{e.preventDefault(),closeAllSections(),openShareSections()});const namePreviuw=document.querySelector(".js-card-nameSurname"),jobPreviuw=document.querySelector(".js-card-profileRole"),telephonePreviuw=document.querySelector(".js-card-telephone"),emailPreviuw=document.querySelector(".js-card-mail"),githubPreviuw=document.querySelector(".js-card-github"),linkedinPreviuw=document.querySelector(".js-card-linkedin"),reset=document.querySelector(".js-reset"),photoPreview=document.querySelector(".js__profile-image"),nameForm=document.querySelector(".js-name"),jobForm=document.querySelector(".js-job"),emailForm=document.querySelector(".js-email"),phoneForm=document.querySelector(".js-phone"),linkedinForm=document.querySelector(".js-linkedin"),githubForm=document.querySelector(".js-github"),photoForm=document.querySelector(".js__profile-preview"),color1=document.querySelector(".js-color1"),color2=document.querySelector(".js-color2"),color3=document.querySelector(".js-color3");function handleInputName(){data.name=nameForm.value,updateForm(),localStorage.setItem("formData",JSON.stringify(data))}function handleInputJob(){data.job=jobForm.value,updateForm(),localStorage.setItem("formData",JSON.stringify(data))}function handleInputEmail(){data.email=emailForm.value,updateForm(),localStorage.setItem("formData",JSON.stringify(data))}function handleInputPhone(){data.phone=phoneForm.value,updateForm(),localStorage.setItem("formData",JSON.stringify(data))}function handleInputLinkedin(){data.linkedin=linkedinForm.value,updateForm(),localStorage.setItem("formData",JSON.stringify(data))}function handleInputGithub(){data.github=githubForm.value,updateForm(),localStorage.setItem("formData",JSON.stringify(data))}function handleResetClick(e){e.preventDefault();data.palette="1",data.name="",data.job="",data.phone="",data.photo="./assets/images/default.png",data.email="",data.linkedin="",data.github="",color1.checked=!0,nameForm.value=data.name,jobForm.value=data.job,emailForm.value=data.email,phoneForm.value=data.phone,linkedinForm.value=data.linkedin,githubForm.value=data.github,photoForm.style.backgroundImage="",photoPreview.style.backgroundImage=`url(${data.photo})`,removeColors(),addColor("palette1"),shareMessage.classList.add("hiddenField"),twitterButton.classList.add("hiddenField"),shareUrl.classList.add("hiddenField"),localStorage.setItem("formData",JSON.stringify(data)),updateForm()}function updateForm(){""===nameForm.value?namePreviuw.innerHTML="Nombre Apellido":namePreviuw.innerHTML=nameForm.value,""===jobForm.value?jobPreviuw.innerHTML="Front-end developer":jobPreviuw.innerHTML=jobForm.value,""===emailForm.value?emailPreviuw.classList.add("disabled-link"):(emailPreviuw.href="mailto:"+emailForm.value,emailPreviuw.classList.remove("disabled-link")),""===phoneForm.value?telephonePreviuw.classList.add("disabled-link"):(telephonePreviuw.href="tel:"+phoneForm.value,telephonePreviuw.classList.remove("disabled-link")),""===githubForm.value?githubPreviuw.classList.add("disabled-link"):(githubPreviuw.href="https://www."+githubForm.value,githubPreviuw.classList.remove("disabled-link")),""===linkedinForm.value?linkedinPreviuw.classList.add("disabled-link"):(linkedinPreviuw.href="https://www."+linkedinForm.value,linkedinPreviuw.classList.remove("disabled-link"));""===photoForm.style.backgroundImage?photoPreview.style.backgroundImage="url(./assets/images/default.png)":photoPreview.style.backgroundImage=photoForm.style.backgroundImage}function removeColors(){namePreview.classList.remove("palette1"),namePreview.classList.remove("palette2"),namePreview.classList.remove("palette3"),telephonePreview.classList.remove("palette1"),telephonePreview.classList.remove("palette2"),telephonePreview.classList.remove("palette3"),githubPreview.classList.remove("palette1"),githubPreview.classList.remove("palette2"),githubPreview.classList.remove("palette3"),linkelinPreview.classList.remove("palette1"),linkelinPreview.classList.remove("palette2"),linkelinPreview.classList.remove("palette3"),emailPreview.classList.remove("palette1"),emailPreview.classList.remove("palette2"),emailPreview.classList.remove("palette3"),linePreview.classList.remove("palette1"),linePreview.classList.remove("palette2"),linePreview.classList.remove("palette3"),borderPreview.classList.remove("palette1"),borderPreview.classList.remove("palette2"),borderPreview.classList.remove("palette3")}function addColor(e){namePreview.classList.add(e),telephonePreview.classList.add(e),emailPreview.classList.add(e),githubPreview.classList.add(e),linkelinPreview.classList.add(e),linePreview.classList.add(e),borderPreview.classList.add(e)}function handleClick(e){data.palette=e.target.id,localStorage.setItem("formData",JSON.stringify(data)),"1"===e.target.id&&(removeColors(),addColor("palette1")),"2"===e.target.id&&(removeColors(),addColor("palette2")),"3"===e.target.id&&(removeColors(),addColor("palette3"))}nameForm.addEventListener("keyup",handleInputName),jobForm.addEventListener("keyup",handleInputJob),emailForm.addEventListener("keyup",handleInputEmail),phoneForm.addEventListener("keyup",handleInputPhone),linkedinForm.addEventListener("keyup",handleInputLinkedin),githubForm.addEventListener("keyup",handleInputGithub),reset.addEventListener("click",handleResetClick),containerColor.addEventListener("click",handleClick);const fr=new FileReader,fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,data.photo=fr.result,localStorage.setItem("formData",JSON.stringify(data))}fileField.addEventListener("change",getImage);const localStorageData=JSON.parse(localStorage.getItem("formData"));if(localStorageData){data=localStorageData,nameForm.value=data.name,emailForm.value=data.email,phoneForm.value=data.phone;const e="./assets/images/default.png";data.photo===e?photoForm.style.backgroundImage="":photoForm.style.backgroundImage=`url(${data.photo})`,photoPreview.style.backgroundImage=`url(${data.photo})`,linkedinForm.value=data.linkedin,githubForm.value=data.github,jobForm.value=data.job,"1"===data.palette?color1.checked=!0:"2"===data.palette?color2.checked=!0:color3.checked=!0,updateForm(),removeColors(),addColor("palette"+data.palette)}const shareButton=document.querySelector(".js-share--button__create"),shareMessage=document.querySelector(".js-share--button2__text"),shareUrl=document.querySelector(".js-share--button2__nav"),twitterButton=document.querySelector(".js-share--button2__twitter");function checkRequiredFields(){let e="",t="";if(nameForm.value||(t=t+="nombre,"),jobForm.value||(t=t+="puesto,"),data.photo||(t=t+="foto,"),emailForm.value||(t=t+="email,"),githubForm.value||(t=t+="github,"),linkedinForm.value||(t=t+="linkedin,"),t){e="No se ha podido generar la tarjeta. Debe rellenar los campos requeridos: "+t.slice(0,-1)}return e}function handleClickShare(e){e.preventDefault(),console.log("Entra en share"),console.log(data);let t=checkRequiredFields();0===t.length&&(fetch("https://dev.adalab.es/api/card/",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(data)}).then(e=>e.json()).then(e=>{e.success?(shareMessage.innerHTML="La tarjeta ha sido creada:",shareUrl.innerHTML=e.cardURL,shareUrl.href=e.cardURL,twitterButton.classList.remove("hiddenField"),shareUrl.classList.remove("hiddenField")):(shareMessage.innerHTML=e.error,shareUrl.href="")}),shareMessage.classList.remove("hiddenField")),shareMessage.innerHTML=t,shareMessage.classList.remove("hiddenField"),twitterButton.classList.add("hiddenField"),shareUrl.classList.add("hiddenField")}shareButton.addEventListener("click",handleClickShare);